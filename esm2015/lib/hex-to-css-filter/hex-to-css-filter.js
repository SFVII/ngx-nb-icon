import { Solver } from './solver';
import { Color } from './color';
/**
 * Transform a CSS Color from Hexadecimal to RGB color
 *
 * @param {string} hex hexadecimal color
 * @returns {([number, number, number] | [])} array with the RGB colors or empty array
 */
const hexToRgb = (hex) => {
    if (hex.length === 4) {
        return [parseInt(`0x${hex[1]}${hex[1]}`), parseInt(`0x${hex[2]}${hex[2]}`), parseInt(`0x${hex[3]}${hex[3]}`)];
    }
    if (hex.length === 7) {
        return [parseInt(`0x${hex[1]}${hex[2]}`), parseInt(`0x${hex[3]}${hex[4]}`), parseInt(`0x${hex[5]}${hex[6]}`)];
    }
    return [];
};
const isNumeric = (n) => !isNaN(parseFloat(n)) && isFinite(n);
// Memory cache for the computed results to avoid multiple
// calculations for the same color
let results = {};
/**
 * A function that transforms a HEX color into CSS filters
 *
 * @param colorValue string hexadecimal color
 * @param opts HexToCssConfiguration function configuration
 *
 */
export const hexToCSSFilter = (colorValue, opts = {}) => {
    let red;
    let green;
    let blue;
    if (results[colorValue] && !opts.forceFilterRecalculation) {
        return Object.assign({}, results[colorValue], { cache: true });
    }
    let color;
    try {
        [red, green, blue] = hexToRgb(colorValue);
        if (!isNumeric(red) || !isNumeric(green) || !isNumeric(blue)) {
            throw new Error(`hextToRgb returned an invalid value for '${colorValue}'`);
        }
        color = new Color(Number(red), Number(green), Number(blue));
    }
    catch (error) {
        throw new Error(`Color value should be in HEX format. ${error}`);
    }
    const solver = new Solver(color, Object.assign({}, 
    // `HexToCssConfiguration` Defaults
    {
        acceptanceLossPercentage: 5,
        maxChecks: 30,
        forceFilterRecalculation: false,
    }, opts));
    return (results[colorValue] = Object.assign({}, solver.solve(), {
        hex: colorValue,
        rgb: [red, green, blue],
        cache: false,
    }));
};
/**
 * A function that clears cached results
 *
 * @param  {string} key? HEX string value passed previously `#24639C`. If not passed, it clears all cached results
 * @returns void
 */
export const clearCache = (key) => {
    if (!key) {
        results = {};
    }
    else if (results[key]) {
        delete results[key];
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGV4LXRvLWNzcy1maWx0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9ub3dib2FyZC1pY29uL3NyYy9saWIvaGV4LXRvLWNzcy1maWx0ZXIvaGV4LXRvLWNzcy1maWx0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUNsQyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBRWhDOzs7OztHQUtHO0FBQ0gsTUFBTSxRQUFRLEdBQUcsQ0FBQyxHQUFXLEVBQWlDLEVBQUU7SUFDOUQsSUFBSSxHQUFHLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtRQUNwQixPQUFPLENBQUMsUUFBUSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsUUFBUSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsUUFBUSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBSTNHLENBQUM7S0FDSDtJQUVELElBQUksR0FBRyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7UUFDcEIsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUkzRyxDQUFDO0tBQ0g7SUFFRCxPQUFPLEVBQUUsQ0FBQztBQUNaLENBQUMsQ0FBQztBQUVGLE1BQU0sU0FBUyxHQUFHLENBQUMsQ0FBVSxFQUFXLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBVyxDQUFDLENBQUMsSUFBSSxRQUFRLENBQUMsQ0FBVyxDQUFDLENBQUM7QUFFcEcsMERBQTBEO0FBQzFELGtDQUFrQztBQUNsQyxJQUFJLE9BQU8sR0FFUCxFQUFXLENBQUM7QUFzQ2hCOzs7Ozs7R0FNRztBQUNILE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxDQUFDLFVBQWtCLEVBQUUsT0FBOEIsRUFBRSxFQUFrQixFQUFFO0lBQ3JHLElBQUksR0FBRyxDQUFDO0lBQ1IsSUFBSSxLQUFLLENBQUM7SUFDVixJQUFJLElBQUksQ0FBQztJQUVULElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFO1FBQ3pELE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFtQixDQUFDO0tBQ2xGO0lBRUQsSUFBSSxLQUFZLENBQUM7SUFDakIsSUFBSTtRQUNGLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDMUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUM1RCxNQUFNLElBQUksS0FBSyxDQUFDLDRDQUE0QyxVQUFVLEdBQUcsQ0FBQyxDQUFDO1NBQzVFO1FBRUQsS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7S0FDN0Q7SUFBQyxPQUFPLEtBQUssRUFBRTtRQUNkLE1BQU0sSUFBSSxLQUFLLENBQUMsd0NBQXdDLEtBQUssRUFBRSxDQUFDLENBQUM7S0FDbEU7SUFFRCxNQUFNLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FDdkIsS0FBSyxFQUNMLE1BQU0sQ0FBQyxNQUFNLENBQ1gsRUFBRTtJQUNGLG1DQUFtQztJQUNuQztRQUNFLHdCQUF3QixFQUFFLENBQUM7UUFDM0IsU0FBUyxFQUFFLEVBQUU7UUFDYix3QkFBd0IsRUFBRSxLQUFLO0tBQ2hDLEVBQ0QsSUFBSSxDQUNvQixDQUMzQixDQUFDO0lBRUYsT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDOUQsR0FBRyxFQUFFLFVBQVU7UUFDZixHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQztRQUN2QixLQUFLLEVBQUUsS0FBSztLQUNiLENBQW1CLENBQUMsQ0FBQztBQUN4QixDQUFDLENBQUM7QUFFRjs7Ozs7R0FLRztBQUNILE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBRyxDQUFDLEdBQVksRUFBUSxFQUFFO0lBQy9DLElBQUksQ0FBQyxHQUFHLEVBQUU7UUFDUixPQUFPLEdBQUcsRUFBRSxDQUFDO0tBQ2Q7U0FBTSxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUN2QixPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztLQUNyQjtBQUNILENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNvbHZlciB9IGZyb20gJy4vc29sdmVyJztcbmltcG9ydCB7IENvbG9yIH0gZnJvbSAnLi9jb2xvcic7XG5cbi8qKlxuICogVHJhbnNmb3JtIGEgQ1NTIENvbG9yIGZyb20gSGV4YWRlY2ltYWwgdG8gUkdCIGNvbG9yXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGhleCBoZXhhZGVjaW1hbCBjb2xvclxuICogQHJldHVybnMgeyhbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gfCBbXSl9IGFycmF5IHdpdGggdGhlIFJHQiBjb2xvcnMgb3IgZW1wdHkgYXJyYXlcbiAqL1xuY29uc3QgaGV4VG9SZ2IgPSAoaGV4OiBzdHJpbmcpOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gfCBbXSA9PiB7XG4gIGlmIChoZXgubGVuZ3RoID09PSA0KSB7XG4gICAgcmV0dXJuIFtwYXJzZUludChgMHgke2hleFsxXX0ke2hleFsxXX1gKSwgcGFyc2VJbnQoYDB4JHtoZXhbMl19JHtoZXhbMl19YCksIHBhcnNlSW50KGAweCR7aGV4WzNdfSR7aGV4WzNdfWApXSBhcyBbXG4gICAgICBudW1iZXIsXG4gICAgICBudW1iZXIsXG4gICAgICBudW1iZXIsXG4gICAgXTtcbiAgfVxuXG4gIGlmIChoZXgubGVuZ3RoID09PSA3KSB7XG4gICAgcmV0dXJuIFtwYXJzZUludChgMHgke2hleFsxXX0ke2hleFsyXX1gKSwgcGFyc2VJbnQoYDB4JHtoZXhbM119JHtoZXhbNF19YCksIHBhcnNlSW50KGAweCR7aGV4WzVdfSR7aGV4WzZdfWApXSBhcyBbXG4gICAgICBudW1iZXIsXG4gICAgICBudW1iZXIsXG4gICAgICBudW1iZXIsXG4gICAgXTtcbiAgfVxuXG4gIHJldHVybiBbXTtcbn07XG5cbmNvbnN0IGlzTnVtZXJpYyA9IChuOiB1bmtub3duKTogYm9vbGVhbiA9PiAhaXNOYU4ocGFyc2VGbG9hdChuIGFzIHN0cmluZykpICYmIGlzRmluaXRlKG4gYXMgbnVtYmVyKTtcblxuLy8gTWVtb3J5IGNhY2hlIGZvciB0aGUgY29tcHV0ZWQgcmVzdWx0cyB0byBhdm9pZCBtdWx0aXBsZVxuLy8gY2FsY3VsYXRpb25zIGZvciB0aGUgc2FtZSBjb2xvclxubGV0IHJlc3VsdHM6IHtcbiAgW2s6IHN0cmluZ106IEhleFRvQ3NzUmVzdWx0O1xufSA9IHt9IGFzIGNvbnN0O1xuXG5leHBvcnQgaW50ZXJmYWNlIEhleFRvQ3NzUmVzdWx0IHtcbiAgLyoqIEhvdyBtYW55IHRpbWVzIHRoZSBzY3JpcHQgd2FzIGNhbGxlZCB0byBzb2x2ZSB0aGUgY29sb3IgKi9cbiAgY2FsbGVkOiBudW1iZXI7XG4gIC8qKiBDU1MgZmlsdGVyIGdlbmVyYXRlZCBiYXNlZCBvbiB0aGUgSGV4IGNvbG9yICovXG4gIGZpbHRlcjogc3RyaW5nO1xuICAvKiogVGhlIHJlY2VpdmVkIGNvbG9yICovXG4gIGhleDogc3RyaW5nO1xuICAvKiogUGVyY2VudGFnZSBsb3NzIHZhbHVlIGZvciB0aGUgZ2VuZXJhdGVkIGZpbHRlciAqL1xuICBsb3NzOiBudW1iZXI7XG4gIC8qKiBIZXggY29sb3IgaW4gUkdCICovXG4gIHJnYjogW251bWJlciwgbnVtYmVyLCBudW1iZXJdO1xuICAvKiogUGVyY2VudGFnZSBsb3NzIHBlciBlYWNoIGNvbG9yIHR5cGUgb3JnYW5pemVkIGluIFJHQjogcmVkLCBncmVlbiwgYmx1ZSwgaCwgcywgbC4gKi9cbiAgdmFsdWVzOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl07XG4gIC8qKiBCb29sZWFuIHRoYXQgcmV0dXJucyB0cnVlIGlmIHZhbHVlIHdhcyBwcmV2aW91c2x5IGNvbXB1dGVkLlxuICAgKiBTbyB0aGF0IG1lYW5zIHRoZSByZXR1cm5lZCB2YWx1ZSBpcyBjb21pbmcgZnJvbSB0aGUgaW4tbWVtb3J5IGNhY2hlZCAqL1xuICBjYWNoZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBIZXhUb0Nzc0NvbmZpZ3VyYXRpb24ge1xuICAvKipcbiAgICogQWNjZXB0YWJsZSBjb2xvciBwZXJjZW50YWdlIHRvIGJlIGxvc3QuXG4gICAqIEBkZWZhdWx0IDVcbiAgICovXG4gIGFjY2VwdGFuY2VMb3NzUGVyY2VudGFnZT86IG51bWJlcjtcbiAgLyoqXG4gICAqIE1heGltdW0gY2hlY2tzIHRoYXQgbmVlZHMgdG8gYmUgZG9uZSB0byByZXR1cm4gdGhlIGJlc3QgdmFsdWUuXG4gICAqIEBkZWZhdWx0IDEwXG4gICAqL1xuICBtYXhDaGVja3M/OiBudW1iZXI7XG4gIC8qKlxuICAgKiBCb29sZWFuIHZhbHVlIHRoYXQgZm9yY2VzIHJlY2FsY3VsYXRpb24gZm9yIENTUyBmaWx0ZXIgZ2VuZXJhdGlvbi5cbiAgICogQGRlZmF1bHQgZmFsc2VcbiAgICovXG4gIGZvcmNlRmlsdGVyUmVjYWxjdWxhdGlvbj86IGJvb2xlYW47XG59XG5cbi8qKlxuICogQSBmdW5jdGlvbiB0aGF0IHRyYW5zZm9ybXMgYSBIRVggY29sb3IgaW50byBDU1MgZmlsdGVyc1xuICpcbiAqIEBwYXJhbSBjb2xvclZhbHVlIHN0cmluZyBoZXhhZGVjaW1hbCBjb2xvclxuICogQHBhcmFtIG9wdHMgSGV4VG9Dc3NDb25maWd1cmF0aW9uIGZ1bmN0aW9uIGNvbmZpZ3VyYXRpb25cbiAqXG4gKi9cbmV4cG9ydCBjb25zdCBoZXhUb0NTU0ZpbHRlciA9IChjb2xvclZhbHVlOiBzdHJpbmcsIG9wdHM6IEhleFRvQ3NzQ29uZmlndXJhdGlvbiA9IHt9KTogSGV4VG9Dc3NSZXN1bHQgPT4ge1xuICBsZXQgcmVkO1xuICBsZXQgZ3JlZW47XG4gIGxldCBibHVlO1xuXG4gIGlmIChyZXN1bHRzW2NvbG9yVmFsdWVdICYmICFvcHRzLmZvcmNlRmlsdGVyUmVjYWxjdWxhdGlvbikge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCByZXN1bHRzW2NvbG9yVmFsdWVdLCB7IGNhY2hlOiB0cnVlIH0pIGFzIEhleFRvQ3NzUmVzdWx0O1xuICB9XG5cbiAgbGV0IGNvbG9yOiBDb2xvcjtcbiAgdHJ5IHtcbiAgICBbcmVkLCBncmVlbiwgYmx1ZV0gPSBoZXhUb1JnYihjb2xvclZhbHVlKTtcbiAgICBpZiAoIWlzTnVtZXJpYyhyZWQpIHx8ICFpc051bWVyaWMoZ3JlZW4pIHx8ICFpc051bWVyaWMoYmx1ZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgaGV4dFRvUmdiIHJldHVybmVkIGFuIGludmFsaWQgdmFsdWUgZm9yICcke2NvbG9yVmFsdWV9J2ApO1xuICAgIH1cblxuICAgIGNvbG9yID0gbmV3IENvbG9yKE51bWJlcihyZWQpLCBOdW1iZXIoZ3JlZW4pLCBOdW1iZXIoYmx1ZSkpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ29sb3IgdmFsdWUgc2hvdWxkIGJlIGluIEhFWCBmb3JtYXQuICR7ZXJyb3J9YCk7XG4gIH1cblxuICBjb25zdCBzb2x2ZXIgPSBuZXcgU29sdmVyKFxuICAgIGNvbG9yLFxuICAgIE9iamVjdC5hc3NpZ24oXG4gICAgICB7fSxcbiAgICAgIC8vIGBIZXhUb0Nzc0NvbmZpZ3VyYXRpb25gIERlZmF1bHRzXG4gICAgICB7XG4gICAgICAgIGFjY2VwdGFuY2VMb3NzUGVyY2VudGFnZTogNSxcbiAgICAgICAgbWF4Q2hlY2tzOiAzMCxcbiAgICAgICAgZm9yY2VGaWx0ZXJSZWNhbGN1bGF0aW9uOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICBvcHRzLFxuICAgICkgYXMgSGV4VG9Dc3NDb25maWd1cmF0aW9uLFxuICApO1xuXG4gIHJldHVybiAocmVzdWx0c1tjb2xvclZhbHVlXSA9IE9iamVjdC5hc3NpZ24oe30sIHNvbHZlci5zb2x2ZSgpLCB7XG4gICAgaGV4OiBjb2xvclZhbHVlLFxuICAgIHJnYjogW3JlZCwgZ3JlZW4sIGJsdWVdLFxuICAgIGNhY2hlOiBmYWxzZSxcbiAgfSkgYXMgSGV4VG9Dc3NSZXN1bHQpO1xufTtcblxuLyoqXG4gKiBBIGZ1bmN0aW9uIHRoYXQgY2xlYXJzIGNhY2hlZCByZXN1bHRzXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBrZXk/IEhFWCBzdHJpbmcgdmFsdWUgcGFzc2VkIHByZXZpb3VzbHkgYCMyNDYzOUNgLiBJZiBub3QgcGFzc2VkLCBpdCBjbGVhcnMgYWxsIGNhY2hlZCByZXN1bHRzXG4gKiBAcmV0dXJucyB2b2lkXG4gKi9cbmV4cG9ydCBjb25zdCBjbGVhckNhY2hlID0gKGtleT86IHN0cmluZyk6IHZvaWQgPT4ge1xuICBpZiAoIWtleSkge1xuICAgIHJlc3VsdHMgPSB7fTtcbiAgfSBlbHNlIGlmIChyZXN1bHRzW2tleV0pIHtcbiAgICBkZWxldGUgcmVzdWx0c1trZXldO1xuICB9XG59O1xuIl19