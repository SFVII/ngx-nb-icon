class Color {
    constructor(r, g, b) {
        this.r = 0;
        this.g = 0;
        this.b = 0;
        this.set(r, g, b);
    }
    set(r, g, b) {
        this.r = this.clamp(r);
        this.g = this.clamp(g);
        this.b = this.clamp(b);
    }
    /**
     * Applying cals to get CSS filter for hue-rotate
     *
     * @param {number} [angle=0]
     * @memberof Color
     */
    hueRotate(angle = 0) {
        angle = (angle / 180) * Math.PI;
        const sin = Math.sin(angle);
        const cos = Math.cos(angle);
        this.multiply([
            0.213 + cos * 0.787 - sin * 0.213,
            0.715 - cos * 0.715 - sin * 0.715,
            0.072 - cos * 0.072 + sin * 0.928,
            0.213 - cos * 0.213 + sin * 0.143,
            0.715 + cos * 0.285 + sin * 0.14,
            0.072 - cos * 0.072 - sin * 0.283,
            0.213 - cos * 0.213 - sin * 0.787,
            0.715 - cos * 0.715 + sin * 0.715,
            0.072 + cos * 0.928 + sin * 0.072,
        ]);
    }
    /**
     * Applying cals to get CSS filter for grayscale
     *
     * @param {number} [value=1]
     * @memberof Color
     */
    grayscale(value = 1) {
        this.multiply([
            0.2126 + 0.7874 * (1 - value),
            0.7152 - 0.7152 * (1 - value),
            0.0722 - 0.0722 * (1 - value),
            0.2126 - 0.2126 * (1 - value),
            0.7152 + 0.2848 * (1 - value),
            0.0722 - 0.0722 * (1 - value),
            0.2126 - 0.2126 * (1 - value),
            0.7152 - 0.7152 * (1 - value),
            0.0722 + 0.9278 * (1 - value),
        ]);
    }
    /**
     * Applying cals to get CSS filter for sepia
     *
     * @param {number} [value=1]
     * @memberof Color
     */
    sepia(value = 1) {
        this.multiply([
            0.393 + 0.607 * (1 - value),
            0.769 - 0.769 * (1 - value),
            0.189 - 0.189 * (1 - value),
            0.349 - 0.349 * (1 - value),
            0.686 + 0.314 * (1 - value),
            0.168 - 0.168 * (1 - value),
            0.272 - 0.272 * (1 - value),
            0.534 - 0.534 * (1 - value),
            0.131 + 0.869 * (1 - value),
        ]);
    }
    /**
     * Applying cals to get CSS filter for saturate
     *
     * @param {number} [value=1]
     * @memberof Color
     */
    saturate(value = 1) {
        this.multiply([
            0.213 + 0.787 * value,
            0.715 - 0.715 * value,
            0.072 - 0.072 * value,
            0.213 - 0.213 * value,
            0.715 + 0.285 * value,
            0.072 - 0.072 * value,
            0.213 - 0.213 * value,
            0.715 - 0.715 * value,
            0.072 + 0.928 * value,
        ]);
    }
    multiply(matrix) {
        // These values are needed. It's correct because the returned values will change
        const newR = this.clamp(this.r * matrix[0] + this.g * matrix[1] + this.b * matrix[2]);
        const newG = this.clamp(this.r * matrix[3] + this.g * matrix[4] + this.b * matrix[5]);
        const newB = this.clamp(this.r * matrix[6] + this.g * matrix[7] + this.b * matrix[8]);
        this.r = newR;
        this.g = newG;
        this.b = newB;
    }
    /**
     * Applying cals to get CSS filter for brightness
     *
     * @param {number} [value=1]
     * @memberof Color
     */
    brightness(value = 1) {
        this.linear(value);
    }
    /**
     * Applying cals to get CSS filter for contrast
     *
     * @param {number} [value=1]
     * @memberof Color
     */
    contrast(value = 1) {
        this.linear(value, -(0.5 * value) + 0.5);
    }
    linear(slope = 1, intercept = 0) {
        this.r = this.clamp(this.r * slope + intercept * 255);
        this.g = this.clamp(this.g * slope + intercept * 255);
        this.b = this.clamp(this.b * slope + intercept * 255);
    }
    /**
     * Applying cals to get CSS filter for invert
     *
     * @param {number} [value=1]
     * @memberof Color
     */
    invert(value = 1) {
        this.r = this.clamp((value + (this.r / 255) * (1 - 2 * value)) * 255);
        this.g = this.clamp((value + (this.g / 255) * (1 - 2 * value)) * 255);
        this.b = this.clamp((value + (this.b / 255) * (1 - 2 * value)) * 255);
    }
    /**
     * transform RGB into HSL values
     *
     * @returns {HSLData}
     * @memberof Color
     */
    hsl() {
        const red = this.r / 255;
        const green = this.g / 255;
        const blue = this.b / 255;
        // find greatest and smallest channel values
        const max = Math.max(red, green, blue);
        const min = Math.min(red, green, blue);
        let hue = 0;
        let saturation = 0;
        const lightness = (max + min) / 2;
        // If min and max have the same values, it means
        // the given color is achromatic
        if (max === min) {
            return {
                h: 0,
                s: 0,
                l: lightness * 100,
            };
        }
        // Adding delta value of greatest and smallest channel values
        const delta = max - min;
        saturation = lightness > 0.5 ? delta / (2 - max - min) : delta / (max + min);
        if (max === red) {
            hue = (green - blue) / delta + (green < blue ? 6 : 0);
        }
        else if (max === green) {
            hue = (blue - red) / delta + 2;
        }
        else if (max === blue) {
            hue = (red - green) / delta + 4;
        }
        hue /= 6;
        return {
            h: hue * 100,
            s: saturation * 100,
            l: lightness * 100,
        };
    }
    /**
     * Normalize the value to follow the min and max for RGB colors
     * min: 0
     * max: 255
     *
     * @private
     * @param {number} value
     * @returns {number}
     * @memberof Color
     */
    clamp(value) {
        // Minimum RGB Value = 0;
        // Maximum RGB Value = 255;
        return Math.min(Math.max(value, 0), 255);
    }
}
export { Color };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29sb3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9ub3dib2FyZC1pY29uL3NyYy9saWIvaGV4LXRvLWNzcy1maWx0ZXIvY29sb3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBTUEsTUFBTSxLQUFLO0lBS1QsWUFBWSxDQUFTLEVBQUUsQ0FBUyxFQUFFLENBQVM7UUFKM0MsTUFBQyxHQUFHLENBQUMsQ0FBQztRQUNOLE1BQUMsR0FBRyxDQUFDLENBQUM7UUFDTixNQUFDLEdBQUcsQ0FBQyxDQUFDO1FBR0osSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3BCLENBQUM7SUFFRCxHQUFHLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxDQUFTO1FBQ2pDLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QixJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdkIsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pCLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILFNBQVMsQ0FBQyxLQUFLLEdBQUcsQ0FBQztRQUNqQixLQUFLLEdBQUcsQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNoQyxNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFNUIsSUFBSSxDQUFDLFFBQVEsQ0FBQztZQUNaLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxJQUFJO1lBQ2hDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1lBQ2pDLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLO1NBQ2xDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILFNBQVMsQ0FBQyxLQUFLLEdBQUcsQ0FBQztRQUNqQixJQUFJLENBQUMsUUFBUSxDQUFDO1lBQ1osTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFDN0IsTUFBTSxHQUFHLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7WUFD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T0FLRztJQUNILFFBQVEsQ0FBQyxLQUFLLEdBQUcsQ0FBQztRQUNoQixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFFTyxNQUFNLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRSxTQUFTLEdBQUcsQ0FBQztRQUNyQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLEdBQUcsU0FBUyxHQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssR0FBRyxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxHQUFHLFNBQVMsR0FBRyxHQUFHLENBQUMsQ0FBQztJQUN4RCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxNQUFNLENBQUMsS0FBSyxHQUFHLENBQUM7UUFDZCxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ3RFLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDdEUsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztJQUN4RSxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxHQUFHO1FBQ0QsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDekIsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDM0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFFMUIsNENBQTRDO1FBQzVDLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN2QyxNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFdkMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ1osSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDO1FBQ25CLE1BQU0sU0FBUyxHQUFHLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUVsQyxnREFBZ0Q7UUFDaEQsZ0NBQWdDO1FBQ2hDLElBQUksR0FBRyxLQUFLLEdBQUcsRUFBRTtZQUNmLE9BQU87Z0JBQ0wsQ0FBQyxFQUFFLENBQUM7Z0JBQ0osQ0FBQyxFQUFFLENBQUM7Z0JBQ0osQ0FBQyxFQUFFLFNBQVMsR0FBRyxHQUFHO2FBQ25CLENBQUM7U0FDSDtRQUVELDZEQUE2RDtRQUM3RCxNQUFNLEtBQUssR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDO1FBRXhCLFVBQVUsR0FBRyxTQUFTLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFFN0UsSUFBSSxHQUFHLEtBQUssR0FBRyxFQUFFO1lBQ2YsR0FBRyxHQUFHLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLEtBQUssR0FBRyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdkQ7YUFBTSxJQUFJLEdBQUcsS0FBSyxLQUFLLEVBQUU7WUFDeEIsR0FBRyxHQUFHLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxHQUFHLEtBQUssR0FBRyxDQUFDLENBQUM7U0FDaEM7YUFBTSxJQUFJLEdBQUcsS0FBSyxJQUFJLEVBQUU7WUFDdkIsR0FBRyxHQUFHLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxHQUFHLEtBQUssR0FBRyxDQUFDLENBQUM7U0FDakM7UUFFRCxHQUFHLElBQUksQ0FBQyxDQUFDO1FBRVQsT0FBTztZQUNMLENBQUMsRUFBRSxHQUFHLEdBQUcsR0FBRztZQUNaLENBQUMsRUFBRSxVQUFVLEdBQUcsR0FBRztZQUNuQixDQUFDLEVBQUUsU0FBUyxHQUFHLEdBQUc7U0FDbkIsQ0FBQztJQUNKLENBQUM7SUFFRDs7Ozs7Ozs7O09BU0c7SUFDSyxLQUFLLENBQUMsS0FBYTtRQUN6Qix5QkFBeUI7UUFDekIsMkJBQTJCO1FBQzNCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUMzQyxDQUFDO0NBQ0Y7QUFFRCxPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgSFNMRGF0YSB7XG4gIGg6IG51bWJlcjtcbiAgczogbnVtYmVyO1xuICBsOiBudW1iZXI7XG59XG5cbmNsYXNzIENvbG9yIHtcbiAgciA9IDA7XG4gIGcgPSAwO1xuICBiID0gMDtcblxuICBjb25zdHJ1Y3RvcihyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyKSB7XG4gICAgdGhpcy5zZXQociwgZywgYik7XG4gIH1cblxuICBzZXQocjogbnVtYmVyLCBnOiBudW1iZXIsIGI6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuciA9IHRoaXMuY2xhbXAocik7XG4gICAgdGhpcy5nID0gdGhpcy5jbGFtcChnKTtcbiAgICB0aGlzLmIgPSB0aGlzLmNsYW1wKGIpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5aW5nIGNhbHMgdG8gZ2V0IENTUyBmaWx0ZXIgZm9yIGh1ZS1yb3RhdGVcbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IFthbmdsZT0wXVxuICAgKiBAbWVtYmVyb2YgQ29sb3JcbiAgICovXG4gIGh1ZVJvdGF0ZShhbmdsZSA9IDApOiB2b2lkIHtcbiAgICBhbmdsZSA9IChhbmdsZSAvIDE4MCkgKiBNYXRoLlBJO1xuICAgIGNvbnN0IHNpbiA9IE1hdGguc2luKGFuZ2xlKTtcbiAgICBjb25zdCBjb3MgPSBNYXRoLmNvcyhhbmdsZSk7XG5cbiAgICB0aGlzLm11bHRpcGx5KFtcbiAgICAgIDAuMjEzICsgY29zICogMC43ODcgLSBzaW4gKiAwLjIxMyxcbiAgICAgIDAuNzE1IC0gY29zICogMC43MTUgLSBzaW4gKiAwLjcxNSxcbiAgICAgIDAuMDcyIC0gY29zICogMC4wNzIgKyBzaW4gKiAwLjkyOCxcbiAgICAgIDAuMjEzIC0gY29zICogMC4yMTMgKyBzaW4gKiAwLjE0MyxcbiAgICAgIDAuNzE1ICsgY29zICogMC4yODUgKyBzaW4gKiAwLjE0LFxuICAgICAgMC4wNzIgLSBjb3MgKiAwLjA3MiAtIHNpbiAqIDAuMjgzLFxuICAgICAgMC4yMTMgLSBjb3MgKiAwLjIxMyAtIHNpbiAqIDAuNzg3LFxuICAgICAgMC43MTUgLSBjb3MgKiAwLjcxNSArIHNpbiAqIDAuNzE1LFxuICAgICAgMC4wNzIgKyBjb3MgKiAwLjkyOCArIHNpbiAqIDAuMDcyLFxuICAgIF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5aW5nIGNhbHMgdG8gZ2V0IENTUyBmaWx0ZXIgZm9yIGdyYXlzY2FsZVxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gW3ZhbHVlPTFdXG4gICAqIEBtZW1iZXJvZiBDb2xvclxuICAgKi9cbiAgZ3JheXNjYWxlKHZhbHVlID0gMSk6IHZvaWQge1xuICAgIHRoaXMubXVsdGlwbHkoW1xuICAgICAgMC4yMTI2ICsgMC43ODc0ICogKDEgLSB2YWx1ZSksXG4gICAgICAwLjcxNTIgLSAwLjcxNTIgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMDcyMiAtIDAuMDcyMiAqICgxIC0gdmFsdWUpLFxuICAgICAgMC4yMTI2IC0gMC4yMTI2ICogKDEgLSB2YWx1ZSksXG4gICAgICAwLjcxNTIgKyAwLjI4NDggKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMDcyMiAtIDAuMDcyMiAqICgxIC0gdmFsdWUpLFxuICAgICAgMC4yMTI2IC0gMC4yMTI2ICogKDEgLSB2YWx1ZSksXG4gICAgICAwLjcxNTIgLSAwLjcxNTIgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMDcyMiArIDAuOTI3OCAqICgxIC0gdmFsdWUpLFxuICAgIF0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5aW5nIGNhbHMgdG8gZ2V0IENTUyBmaWx0ZXIgZm9yIHNlcGlhXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbdmFsdWU9MV1cbiAgICogQG1lbWJlcm9mIENvbG9yXG4gICAqL1xuICBzZXBpYSh2YWx1ZSA9IDEpOiB2b2lkIHtcbiAgICB0aGlzLm11bHRpcGx5KFtcbiAgICAgIDAuMzkzICsgMC42MDcgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuNzY5IC0gMC43NjkgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMTg5IC0gMC4xODkgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMzQ5IC0gMC4zNDkgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuNjg2ICsgMC4zMTQgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMTY4IC0gMC4xNjggKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMjcyIC0gMC4yNzIgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuNTM0IC0gMC41MzQgKiAoMSAtIHZhbHVlKSxcbiAgICAgIDAuMTMxICsgMC44NjkgKiAoMSAtIHZhbHVlKSxcbiAgICBdKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBseWluZyBjYWxzIHRvIGdldCBDU1MgZmlsdGVyIGZvciBzYXR1cmF0ZVxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gW3ZhbHVlPTFdXG4gICAqIEBtZW1iZXJvZiBDb2xvclxuICAgKi9cbiAgc2F0dXJhdGUodmFsdWUgPSAxKTogdm9pZCB7XG4gICAgdGhpcy5tdWx0aXBseShbXG4gICAgICAwLjIxMyArIDAuNzg3ICogdmFsdWUsXG4gICAgICAwLjcxNSAtIDAuNzE1ICogdmFsdWUsXG4gICAgICAwLjA3MiAtIDAuMDcyICogdmFsdWUsXG4gICAgICAwLjIxMyAtIDAuMjEzICogdmFsdWUsXG4gICAgICAwLjcxNSArIDAuMjg1ICogdmFsdWUsXG4gICAgICAwLjA3MiAtIDAuMDcyICogdmFsdWUsXG4gICAgICAwLjIxMyAtIDAuMjEzICogdmFsdWUsXG4gICAgICAwLjcxNSAtIDAuNzE1ICogdmFsdWUsXG4gICAgICAwLjA3MiArIDAuOTI4ICogdmFsdWUsXG4gICAgXSk7XG4gIH1cblxuICBwcml2YXRlIG11bHRpcGx5KG1hdHJpeDogbnVtYmVyW10pOiB2b2lkIHtcbiAgICAvLyBUaGVzZSB2YWx1ZXMgYXJlIG5lZWRlZC4gSXQncyBjb3JyZWN0IGJlY2F1c2UgdGhlIHJldHVybmVkIHZhbHVlcyB3aWxsIGNoYW5nZVxuICAgIGNvbnN0IG5ld1IgPSB0aGlzLmNsYW1wKHRoaXMuciAqIG1hdHJpeFswXSArIHRoaXMuZyAqIG1hdHJpeFsxXSArIHRoaXMuYiAqIG1hdHJpeFsyXSk7XG4gICAgY29uc3QgbmV3RyA9IHRoaXMuY2xhbXAodGhpcy5yICogbWF0cml4WzNdICsgdGhpcy5nICogbWF0cml4WzRdICsgdGhpcy5iICogbWF0cml4WzVdKTtcbiAgICBjb25zdCBuZXdCID0gdGhpcy5jbGFtcCh0aGlzLnIgKiBtYXRyaXhbNl0gKyB0aGlzLmcgKiBtYXRyaXhbN10gKyB0aGlzLmIgKiBtYXRyaXhbOF0pO1xuICAgIHRoaXMuciA9IG5ld1I7XG4gICAgdGhpcy5nID0gbmV3RztcbiAgICB0aGlzLmIgPSBuZXdCO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5aW5nIGNhbHMgdG8gZ2V0IENTUyBmaWx0ZXIgZm9yIGJyaWdodG5lc3NcbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IFt2YWx1ZT0xXVxuICAgKiBAbWVtYmVyb2YgQ29sb3JcbiAgICovXG4gIGJyaWdodG5lc3ModmFsdWUgPSAxKTogdm9pZCB7XG4gICAgdGhpcy5saW5lYXIodmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFwcGx5aW5nIGNhbHMgdG8gZ2V0IENTUyBmaWx0ZXIgZm9yIGNvbnRyYXN0XG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbdmFsdWU9MV1cbiAgICogQG1lbWJlcm9mIENvbG9yXG4gICAqL1xuICBjb250cmFzdCh2YWx1ZSA9IDEpOiB2b2lkIHtcbiAgICB0aGlzLmxpbmVhcih2YWx1ZSwgLSgwLjUgKiB2YWx1ZSkgKyAwLjUpO1xuICB9XG5cbiAgcHJpdmF0ZSBsaW5lYXIoc2xvcGUgPSAxLCBpbnRlcmNlcHQgPSAwKSB7XG4gICAgdGhpcy5yID0gdGhpcy5jbGFtcCh0aGlzLnIgKiBzbG9wZSArIGludGVyY2VwdCAqIDI1NSk7XG4gICAgdGhpcy5nID0gdGhpcy5jbGFtcCh0aGlzLmcgKiBzbG9wZSArIGludGVyY2VwdCAqIDI1NSk7XG4gICAgdGhpcy5iID0gdGhpcy5jbGFtcCh0aGlzLmIgKiBzbG9wZSArIGludGVyY2VwdCAqIDI1NSk7XG4gIH1cblxuICAvKipcbiAgICogQXBwbHlpbmcgY2FscyB0byBnZXQgQ1NTIGZpbHRlciBmb3IgaW52ZXJ0XG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBbdmFsdWU9MV1cbiAgICogQG1lbWJlcm9mIENvbG9yXG4gICAqL1xuICBpbnZlcnQodmFsdWUgPSAxKTogdm9pZCB7XG4gICAgdGhpcy5yID0gdGhpcy5jbGFtcCgodmFsdWUgKyAodGhpcy5yIC8gMjU1KSAqICgxIC0gMiAqIHZhbHVlKSkgKiAyNTUpO1xuICAgIHRoaXMuZyA9IHRoaXMuY2xhbXAoKHZhbHVlICsgKHRoaXMuZyAvIDI1NSkgKiAoMSAtIDIgKiB2YWx1ZSkpICogMjU1KTtcbiAgICB0aGlzLmIgPSB0aGlzLmNsYW1wKCh2YWx1ZSArICh0aGlzLmIgLyAyNTUpICogKDEgLSAyICogdmFsdWUpKSAqIDI1NSk7XG4gIH1cblxuICAvKipcbiAgICogdHJhbnNmb3JtIFJHQiBpbnRvIEhTTCB2YWx1ZXNcbiAgICpcbiAgICogQHJldHVybnMge0hTTERhdGF9XG4gICAqIEBtZW1iZXJvZiBDb2xvclxuICAgKi9cbiAgaHNsKCk6IEhTTERhdGEge1xuICAgIGNvbnN0IHJlZCA9IHRoaXMuciAvIDI1NTtcbiAgICBjb25zdCBncmVlbiA9IHRoaXMuZyAvIDI1NTtcbiAgICBjb25zdCBibHVlID0gdGhpcy5iIC8gMjU1O1xuXG4gICAgLy8gZmluZCBncmVhdGVzdCBhbmQgc21hbGxlc3QgY2hhbm5lbCB2YWx1ZXNcbiAgICBjb25zdCBtYXggPSBNYXRoLm1heChyZWQsIGdyZWVuLCBibHVlKTtcbiAgICBjb25zdCBtaW4gPSBNYXRoLm1pbihyZWQsIGdyZWVuLCBibHVlKTtcblxuICAgIGxldCBodWUgPSAwO1xuICAgIGxldCBzYXR1cmF0aW9uID0gMDtcbiAgICBjb25zdCBsaWdodG5lc3MgPSAobWF4ICsgbWluKSAvIDI7XG5cbiAgICAvLyBJZiBtaW4gYW5kIG1heCBoYXZlIHRoZSBzYW1lIHZhbHVlcywgaXQgbWVhbnNcbiAgICAvLyB0aGUgZ2l2ZW4gY29sb3IgaXMgYWNocm9tYXRpY1xuICAgIGlmIChtYXggPT09IG1pbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaDogMCxcbiAgICAgICAgczogMCxcbiAgICAgICAgbDogbGlnaHRuZXNzICogMTAwLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBBZGRpbmcgZGVsdGEgdmFsdWUgb2YgZ3JlYXRlc3QgYW5kIHNtYWxsZXN0IGNoYW5uZWwgdmFsdWVzXG4gICAgY29uc3QgZGVsdGEgPSBtYXggLSBtaW47XG5cbiAgICBzYXR1cmF0aW9uID0gbGlnaHRuZXNzID4gMC41ID8gZGVsdGEgLyAoMiAtIG1heCAtIG1pbikgOiBkZWx0YSAvIChtYXggKyBtaW4pO1xuXG4gICAgaWYgKG1heCA9PT0gcmVkKSB7XG4gICAgICBodWUgPSAoZ3JlZW4gLSBibHVlKSAvIGRlbHRhICsgKGdyZWVuIDwgYmx1ZSA/IDYgOiAwKTtcbiAgICB9IGVsc2UgaWYgKG1heCA9PT0gZ3JlZW4pIHtcbiAgICAgIGh1ZSA9IChibHVlIC0gcmVkKSAvIGRlbHRhICsgMjtcbiAgICB9IGVsc2UgaWYgKG1heCA9PT0gYmx1ZSkge1xuICAgICAgaHVlID0gKHJlZCAtIGdyZWVuKSAvIGRlbHRhICsgNDtcbiAgICB9XG5cbiAgICBodWUgLz0gNjtcblxuICAgIHJldHVybiB7XG4gICAgICBoOiBodWUgKiAxMDAsXG4gICAgICBzOiBzYXR1cmF0aW9uICogMTAwLFxuICAgICAgbDogbGlnaHRuZXNzICogMTAwLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogTm9ybWFsaXplIHRoZSB2YWx1ZSB0byBmb2xsb3cgdGhlIG1pbiBhbmQgbWF4IGZvciBSR0IgY29sb3JzXG4gICAqIG1pbjogMFxuICAgKiBtYXg6IDI1NVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICogQG1lbWJlcm9mIENvbG9yXG4gICAqL1xuICBwcml2YXRlIGNsYW1wKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIC8vIE1pbmltdW0gUkdCIFZhbHVlID0gMDtcbiAgICAvLyBNYXhpbXVtIFJHQiBWYWx1ZSA9IDI1NTtcbiAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgodmFsdWUsIDApLCAyNTUpO1xuICB9XG59XG5cbmV4cG9ydCB7IENvbG9yIH07XG4iXX0=